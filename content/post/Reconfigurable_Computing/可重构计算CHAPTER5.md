---
# 常用定义

title: "可重构计算-第5章"           # 标题
date: 2023-02-11    # 创建时间
lastmod: 2023-02-12 # 最后修改时间
draft: false                       # 是否是草稿？
tags: ["可重构计算","CGRA"]  # 标签
categories: ["可重构计算读书笔记"]              # 分类
author: "李尚坤"                  # 作者


# 用户自定义

# 你可以选择 关闭(false) 或者 打开(true) 以下选项

comment: false   # 关闭评论
toc: true       # 关闭文章目录

# 你同样可以自定义文章的版权规则

contentCopyright: '<a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a>'
reward: false	 # 关闭打赏
mathjax: true    # 打开 mathjax

---

# 第5章 动态重构与部分重构

 ## 5.1 动态重构与部分重构的概念

### 5.1.1 静态重构

- 比如FPGA，由于采用细粒度的查找表单元，配置文件巨大，导致超长重构时间

### 5.1.2 动态重构

- 比如CGRA，CGRA粒度大配置信息量小，可以在短时间内完成功能重构

### 5.1.3 部分重构

- 数据通路在空间上被划分为多个区域， 每个区域被重构成特定的功能引擎来执行特定的计算任务
  - 静态部分重构：重构时非配置区要停下来
  - 动态部分重构：重构时非配置区可正常执行（CGRA）

## 5.2 配置信息的组织、管理与高速缓存

**配置粒度**

- 一次配置完成的可重构数据通路中被划分出的区域规模
- 细粒度配置：一次只完成一个运算单元的配置
- 中粒度配置：一次完成一块区域的配置（一行、一列，1/2阵列等）
- 粗粒度配置：一次完成整个阵列的配置

### 5.2.1 细粒度配置中配置信息的组织、管理与缓存

- 配置链结构：按固定的顺序，从配置接口开始链接各个运算单元内的配置寄存器，配置信息在配置链中逐级传递，直到匹配目标运算单元
- 配置链结构的重构时间取决于配置信息传到距离接口最远的配置单元的传输时间
- 垂直配置链+水平配置链：先匹配行，再匹配列

### 5.2.2 中粒度配置中配置信息的组织、管理与缓存

- 以运算阵列中的行为单位，依次配置
- 可以方便地实现DFG图到阵列的映射
- 配置流程：
  - 读出步配置信息，缓存在步寄存器中
  - 行配置信息对步配置信息到行配置信息的载入进行控制

### 5.2.3 粗粒度配置中配置信息的组织、管理与缓存

- 配置信息从配置存储器中读出后，直接被写入运算单元内的配置寄存器中
- 完全动态重构：运算单元阵列在运算的过程中每一时钟周期都对阵列功能进行重构
- 完全动态重构产生较高的配置功耗，占40%左右。可以通过压缩连续周期执行相同算子的配置，来减少配置功耗

## 5.3 计算数据的组织、管理与高速缓存

- 数据传输面临存储墙问题
- 现代通用处理器采用处理器与内存之间的多级cache结构
- 可重构系统面临的存储墙问题更加严峻，因为并行计算能力更强

### 5.3.1 细粒度可重构阵列的管理与缓存结构

- 以FPGA为例，FPGA的结构中可以采用少量多块的离散数据缓存结构，提高数据访问速度

### 5.3.2 粗粒度可重构阵列的管理与缓存结构

- 数据预取：可以将数据传输与阵列配置 or 计算过程并行执行
- 随着计算速度的提高，数据预取成为了流水线中的关键路径
- 有的采用与通用处理器类似的方法，增加多层数据缓存结构

### 5.3.3 层次化数据缓存结构

- 计算数据的有效组织与管理可以提高数据吞吐量，减小外村带宽对阵列计算效率的制约

- 可重构系统的存储结构：片外主存，阵列之间的全局存储，阵列独享的共享存储，阵列内的运算单元独享的局部存储

  ![截屏2023-02-10 21.21.41](/imag/可重构计算/图11.png)

  - 片外主存：存储输入数据，中间结果，最终结果
  - 全局存储：存储阵列之间的交互数据，存储可重构阵列与系统访存控制器（DMAC）之间的交互数据
  - 共享存储：存储阵列的可重构结果及少量中间结果
  - 局部存储：避免访存冲突，保证确定的访存时延，保证阵列的计算流水线不会被不确定的访存时延打断