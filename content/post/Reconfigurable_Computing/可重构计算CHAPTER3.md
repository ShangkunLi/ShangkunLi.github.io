---
# 常用定义
title: "可重构计算-第3章"           # 标题
date: 2023-02-04    # 创建时间
lastmod: 2023-02-04 # 最后修改时间
draft: false                       # 是否是草稿？
tags: ["可重构计算","CGRA"]  # 标签
categories: ["可重构计算读书笔记"]              # 分类
author: "李尚坤"                  # 作者


# 用户自定义
# 你可以选择 关闭(false) 或者 打开(true) 以下选项
comment: false   # 关闭评论
toc: true       # 关闭文章目录
# 你同样可以自定义文章的版权规则
contentCopyright: '<a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a>'
reward: false	 # 关闭打赏
mathjax: true    # 打开 mathjax

---

# 第3章 可重构计算处理器硬件架构

## 3.1 可重构数据通路设计

### 3.1.1 可重构计算单元设计

1. 粒度选择

   FPGA为单比特粒度，但配置的面积代价和时间代价很大，无法动态配置。粒度越小越灵活，但需要付出更大的面积和配置时间；粒度越小则配置速度越快，但影响算法映射

2. 寄存选择

   合理的寄存器位置有利于实现流水线等算法加速执行手段

3. 计算功能选择

   - 算术：加减乘除
   - 比较：大于小于等于大于等于
   - 逻辑：与或非异或同或
   - 移位：逻辑左右移，算术左右移
   - 异构：一个大而全的计算单元中，一些功能的使用率很低，这种情况下应该对单元进行适当裁剪以得到基本计算单元的异构形式

### 3.1.2 可重构路由单元设计

- 各种输入输出的选择单元，构成了可重构路由单元

### 3.1.3 阵列接口单元的设计

- 可重构阵列面临存储墙的问题：存储器的接口带宽有限
- 减少接口带宽的需求，在阵列内部设计缓存，数据不再频繁通过外部接口
- 提高接口带宽上限，可以压缩数据：比如输入数据位宽小于接口时，可以将多个数据拼接共用接口
- 合理的FIFO值

### 3.1.4 可重构阵列缓存设计

- 存储系统的好坏决定并行系统吞吐量计算的性能，**分布式存储**是提升可重构计算处理器吞吐效率的方法之一
- 在外部存储器和计算阵列FIFO之间，设计缓存结构
  - 按照数据变化的频率分类

1. 常数和立即数缓存结构

   常数和立即数倍存到阵列专门设置的缓存结构中

2. 变量的堆寄存器结构

   - 短变量在每个周期变化时反复使用；长变量则相隔数个周期再用到

   优点：

   - 可以增加额外的数据通路，实现阵列扩展：可以通过堆寄存器将前一次结果存下来，后面一起输出，这样输出结果会大于阵列宽度，相当于扩大了阵列宽度
   - 缓存中间数据，在两次配置之间传递数据
   - 插入空拍，提高流水线效率

3. 变量的边界存储结构

4. 变量的阵列外部缓存结构

   - 在外部寄存器和计算阵列接口之间放入的缓存单元
   - 针对规则的数据变换使用存储器和控制逻辑可以提高性能
   - 多种数据变换操作

## 3.2 可重构控制器设计

### 3.2.1 配置结构定义

1. 配置系统的层次化设计

   ![截屏2023-01-28 20.15.46](/imag/可重构计算/图9.png)

2. 算子功能编码研究

   - 固定码长，码长由操作的总数目决定
   - 为了降低电路的功耗，对运算单元内部各主要模块做门控电源或时钟
   - 为了降低配置端翻转次数，根据算子的转移概率进行huffman编码

3. 阵列时序模型研究

4. 阵列同步配置信息

   1. 阵列的两种同步方式
      - 在每个子单元的子任务序列中最后一个任务结束后，需要对各个子单元进行同步，以便执行下一个综合任务
      - 子任务之间存在数据时序依赖关系，需要对某几个任务进行同步
   2. 子单元的两种同步时机
      - 后同步
      - 前同步
   3. 同步控制涉及模块
      - 子单元配置字缓存起
      - 同步控制器
   4. 同步信息的描述方式和同步流程

### 3.2.2 配置执行方式

![截屏2023-01-28 20.36.41](/imag/可重构计算/图10.png)

### 3.2.3 配置缓存设计

## 3.3 可重构数据通路与控制器的耦合关系

- 嵌入模式：数据通路在控制器内部实现
- 协处理器模式：数据通路和控制器同一个芯片内连接
- 独立芯片模式：数据通路在控制器芯片外实现

- 一般情况，离控制器越远，对算法的加速效果越好，但是配置的代价也越大